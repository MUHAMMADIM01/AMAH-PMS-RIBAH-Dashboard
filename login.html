<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Login - Amah Admin</title>
  <style>
    body{font-family:Arial;background:#eaf6f6;margin:0}
    .box{max-width:420px;margin:90px auto;background:#fff;padding:22px;border-radius:8px;box-shadow:0 8px 22px rgba(0,0,0,.06)}
    h2{text-align:center;color:#064b62}
    input,button{width:100%;padding:11px;margin:8px 0;border-radius:6px;border:1px solid #cfd8dc}
    button{background:#0b7a78;color:#fff;border:0;cursor:pointer}
    .small{font-size:13px;color:#666}
    .link{display:block;text-align:center;margin-top:10px}
    #msg{color:crimson;text-align:center;margin-top:8px}
  </style>
</head>
<body>
  <div class="box">
    <h2>Admin Login</h2>
    <input id="email" type="email" placeholder="Email" />
    <input id="password" type="password" placeholder="Password" />
    <button id="loginBtn">Login</button>
    <button id="forgot" style="background:#ff7043;margin-top:8px">Forgot Password</button>
    <p id="msg"></p>
    <p class="link small"><a href="signup.html">Create admin account (if none)</a></p>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <script>
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {

  apiKey: "AIzaSyBqXjy7ogO8qMCsfuYB61yBpZJpKKKGhqk",
  
  authDomain: "amahmedicinestore-be61b.firebaseapp.com",
  
  databaseURL: "https://amahmedicinestore-be61b-default-rtdb.firebaseio.com",
  
  projectId: "amahmedicinestore-be61b",
  
  storageBucket: "amahmedicinestore-be61b.appspot.com",
  
  messagingSenderId: "740301709370",
  
  appId: "1:740301709370:web:9fd66894daa25bd85b1503",
  
  measurementId: "G-NV6KNSM3CV"
};
    
    };
    // ======================================================

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    // on login
    document.getElementById('loginBtn').onclick = async () => {
      document.getElementById('msg').textContent = '';
      const email = document.getElementById('email').value.trim();
      const pass = document.getElementById('password').value.trim();
      if(!email || !pass){ document.getElementById('msg').textContent = 'Enter fields'; return; }
      try {
        const cred = await auth.signInWithEmailAndPassword(email, pass);
        const uid = cred.user.uid;
        // check admins node
        const snap = await db.ref('admins/' + uid).once('value');
        if (!snap.exists()) {
          // not marked as admin
          await auth.signOut();
          document.getElementById('msg').textContent = 'This user is not an admin.';
          return;
        }
        // success
        window.location.href = 'dashboard.html';
      } catch(err) {
        console.error(err);
        document.getElementById('msg').textContent = err.message;
      }
    };

    // forgot password
    document.getElementById('forgot').onclick = async () => {
      const email = document.getElementById('email').value.trim();
      if(!email){ document.getElementById('msg').textContent = 'Enter your email to reset'; return; }
      try {
        await auth.sendPasswordResetEmail(email);
        document.getElementById('msg').textContent = 'Password reset email sent.';
      } catch(err) {
        document.getElementById('msg').textContent = err.message;
      }
    };
  </script>
</body>
</html>
